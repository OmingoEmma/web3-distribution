(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{9829:function(e,r,t){Promise.resolve().then(t.bind(t,6683))},9376:function(e,r,t){"use strict";var a=t(5475);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},6683:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return c}});var a=t(7437),s=t(2265),o=t(9376),l=t(1519),n=t(9064);function c(){let{user:e}=(0,l.a)(),r=(0,o.useRouter)();(0,s.useEffect)(()=>{e?"admin"!==e.role&&r.replace("/dashboard"):r.replace("/login")},[e,r]);let{listUsers:t,setUserRole:c,inviteUser:i}=(0,l.a)(),[d,u]=(0,s.useState)(t()),[m,g]=(0,s.useState)({name:"",email:"",role:"creator"}),h=()=>u(t());return e&&"admin"===e.role?(0,a.jsxs)("main",{className:"p-8 max-w-4xl mx-auto space-y-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Manage Users"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Invite users and manage roles."}),(0,a.jsxs)("div",{className:"rounded border border-gray-200 dark:border-gray-700 p-4 space-y-3",children:[(0,a.jsx)("h2",{className:"font-semibold",children:"Invite User"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[(0,a.jsx)("input",{className:"px-3 py-2 rounded border border-gray-300 dark:border-gray-700",placeholder:"Name",value:m.name,onChange:e=>g({...m,name:e.target.value})}),(0,a.jsx)("input",{className:"px-3 py-2 rounded border border-gray-300 dark:border-gray-700",placeholder:"Email",value:m.email,onChange:e=>g({...m,email:e.target.value})}),(0,a.jsxs)("select",{className:"px-3 py-2 rounded border border-gray-300 dark:border-gray-700",value:m.role,onChange:e=>g({...m,role:e.target.value}),children:[(0,a.jsx)("option",{value:"admin",children:"admin"}),(0,a.jsx)("option",{value:"creator",children:"creator"}),(0,a.jsx)("option",{value:"contributor",children:"contributor"})]}),(0,a.jsx)("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>{let e=m.email.trim(),r=(m.name||e.split("@")[0]).trim();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)){n.Am.error("Please enter a valid email address.");return}i(r,e,m.role),n.Am.success("Invite sent to ".concat(e," as ").concat(m.role,".")),g({name:"",email:"",role:"creator"}),h()},children:"Send Invite"})]})]}),(0,a.jsx)("div",{className:"rounded border border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("th",{className:"text-left p-3",children:"Name"}),(0,a.jsx)("th",{className:"text-left p-3",children:"Email"}),(0,a.jsx)("th",{className:"text-left p-3",children:"Role"}),(0,a.jsx)("th",{className:"text-left p-3",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:d.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[(0,a.jsx)("td",{className:"p-3",children:e.name}),(0,a.jsx)("td",{className:"p-3 text-gray-600",children:e.email}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs bg-gray-100 dark:bg-gray-800",children:e.role})}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsxs)("select",{defaultValue:e.role,onChange:r=>{c(e.id,r.target.value),h()},className:"px-2 py-1 rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900",children:[(0,a.jsx)("option",{value:"admin",children:"admin"}),(0,a.jsx)("option",{value:"creator",children:"creator"}),(0,a.jsx)("option",{value:"contributor",children:"contributor"})]})})]},e.id))})]})})]}):null}},1519:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return c},a:function(){return i}});var a=t(7437),s=t(2265);let o=(0,s.createContext)(void 0),l={notifyResurfacingHours:6};function n(e){return"crt_settings_".concat(e)}let c=e=>{let{children:r}=e,[t,c]=(0,s.useState)(null),[i,d]=(0,s.useState)(l);(0,s.useEffect)(()=>{try{let e=localStorage.getItem("crt_user");if(e){let r=JSON.parse(e);c(r);let t=localStorage.getItem(n(r.id));t&&d({...l,...JSON.parse(t)})}}catch(e){}},[]),(0,s.useEffect)(()=>{try{t&&localStorage.setItem(n(t.id),JSON.stringify(i))}catch(e){}},[t,i]);let u=function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"creator",a=JSON.parse(localStorage.getItem("crt_users")||"[]"),s=a.find(r=>r.email===e),o=s||{id:"user_".concat(Math.random().toString(36).slice(2,9)),name:r||e.split("@")[0],email:e,role:t};s||localStorage.setItem("crt_users",JSON.stringify([...a,o])),c(o),localStorage.setItem("crt_user",JSON.stringify(o));try{document.cookie="crt_user=".concat(encodeURIComponent(JSON.stringify(o)),"; path=/")}catch(e){}let i=localStorage.getItem(n(o.id));d(i?{...l,...JSON.parse(i)}:l)},m=(e,r,t)=>{let a={id:"user_".concat(Math.random().toString(36).slice(2,9)),name:e,email:r,role:t},s=JSON.parse(localStorage.getItem("crt_users")||"[]");localStorage.setItem("crt_users",JSON.stringify([...s,a])),localStorage.setItem("crt_user",JSON.stringify(a)),localStorage.setItem(n(a.id),JSON.stringify(l)),c(a),d(l);try{document.cookie="crt_user=".concat(encodeURIComponent(JSON.stringify(a)),"; path=/")}catch(e){}},g=(e,r,t)=>{let a={id:"user_".concat(Math.random().toString(36).slice(2,9)),name:e,email:r,role:t},s=JSON.parse(localStorage.getItem("crt_users")||"[]");localStorage.setItem("crt_users",JSON.stringify([...s,a]))},h=()=>{c(null),localStorage.removeItem("crt_user");try{document.cookie="crt_user=; Max-Age=0; path=/"}catch(e){}},p=e=>{d(r=>({...r,notifyResurfacingHours:e}))},x=()=>{try{return JSON.parse(localStorage.getItem("crt_users")||"[]")}catch(e){return[]}},f=(e,r)=>{try{let t=x().map(t=>t.id===e?{...t,role:r}:t);localStorage.setItem("crt_users",JSON.stringify(t));let a=JSON.parse(localStorage.getItem("crt_user")||"null");if(a&&a.id===e){let e={...a,role:r};localStorage.setItem("crt_user",JSON.stringify(e)),c(e)}}catch(e){}},y=(0,s.useMemo)(()=>({user:t,settings:i,login:u,signup:m,logout:h,setNotifyResurfacingHours:p,listUsers:x,setUserRole:f,inviteUser:g}),[t,i]);return(0,a.jsx)(o.Provider,{value:y,children:r})};function i(){let e=(0,s.useContext)(o);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},function(e){e.O(0,[64,971,117,744],function(){return e(e.s=9829)}),_N_E=e.O()}]);