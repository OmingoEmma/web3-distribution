(()=>{var e={};e.id=203,e.ids=[203],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3819:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>g,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>l}),a(8022),a(3913),a(5866);var r=a(3191),s=a(8716),n=a(7922),i=a.n(n),o=a(5231),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);a.d(t,c);let l=["",{children:["creator",{children:["withdraw",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,8022)),"/workspaces/web3-distribution/src/app/creator/withdraw/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3913)),"/workspaces/web3-distribution/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/workspaces/web3-distribution/src/app/creator/withdraw/page.tsx"],u="/creator/withdraw/page",g={require:a,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/creator/withdraw/page",pathname:"/creator/withdraw",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},925:(e,t,a)=>{Promise.resolve().then(a.bind(a,7984))},541:(e,t,a)=>{"use strict";a.d(t,{M:()=>c});var r=a(326);a(7577);var s=a(434),n=a(5047),i=a(7154);let o=({href:e,label:t,icon:a})=>{let i=(0,n.usePathname)(),o=i===e||i.startsWith(e+"/");return(0,r.jsxs)(s.default,{href:e,className:`flex items-center gap-3 px-4 py-3 rounded-lg text-sm transition-colors ${o?"bg-blue-600 text-white":"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[r.jsx("span",{className:"text-lg",children:a}),r.jsx("span",{className:"font-medium",children:t})]})},c=({children:e})=>{let{user:t,logout:a}=(0,i.a)(),s=(0,n.useRouter)();return t&&("creator"===t.role||"admin"===t.role)?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[r.jsx("nav",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Creator Dashboard"}),r.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded",children:"Creator"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.email}),r.jsx("button",{onClick:()=>{a(),s.push("/login")},className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Logout"})]})]})})}),r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[r.jsx("aside",{className:"col-span-12 lg:col-span-3",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 space-y-2",children:[r.jsx("div",{className:"px-3 py-2 text-xs font-semibold tracking-wide text-gray-500 dark:text-gray-400 uppercase",children:"Navigation"}),r.jsx(o,{href:"/creator/dashboard",label:"Dashboard",icon:"\uD83D\uDCCA"}),r.jsx(o,{href:"/creator/projects",label:"My Projects",icon:"\uD83C\uDFAC"}),r.jsx(o,{href:"/creator/revenue",label:"Revenue",icon:"\uD83D\uDCB0"}),r.jsx(o,{href:"/creator/rights",label:"My Rights",icon:"⚖️"}),r.jsx(o,{href:"/creator/payouts",label:"Payouts",icon:"\uD83D\uDCB8"}),r.jsx(o,{href:"/creator/topup",label:"Top Up",icon:"\uD83D\uDCB3"}),r.jsx(o,{href:"/creator/withdraw",label:"Withdraw",icon:"\uD83C\uDFE6"}),r.jsx(o,{href:"/creator/settings",label:"Settings",icon:"⚙️"})]})}),r.jsx("main",{className:"col-span-12 lg:col-span-9",children:e})]})})]}):null}},7984:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var r=a(326),s=a(7577),n=a(5047),i=a(7154),o=a(541),c=a(6166);class l extends c.b{constructor(){super()}static getInstance(){return l.instance||(l.instance=new l),l.instance}getProviders(){return[{name:"tink",displayName:"Tink (Europe)",supportedRegions:["EU","UK"],supportedCurrencies:["EUR","GBP","SEK","DKK"]},{name:"truelayer",displayName:"TrueLayer (UK/EU)",supportedRegions:["UK","EU"],supportedCurrencies:["GBP","EUR"]},{name:"plaid",displayName:"Plaid (US/Canada)",supportedRegions:["US","CA"],supportedCurrencies:["USD","CAD"]},{name:"chimoney",displayName:"Chimoney (Global)",supportedRegions:["Global"],supportedCurrencies:["USD","EUR","GBP","NGN","KES","GHS","ZAR"]},{name:"paystack",displayName:"Paystack (Africa)",supportedRegions:["NG","GH","ZA","KE"],supportedCurrencies:["NGN","GHS","ZAR","KES"]}]}async createWithdrawal(e){try{let t=this.getExchangeRate(e.cryptoCurrency,e.fiatCurrency),a=e.cryptoAmount*t,r={transactionId:`offramp_${Date.now()}_${Math.random().toString(36).slice(2,9)}`,provider:e.provider,status:"pending",cryptoAmount:e.cryptoAmount,cryptoCurrency:e.cryptoCurrency,fiatAmount:a,fiatCurrency:e.fiatCurrency,bankAccountId:e.bankAccountId,walletAddress:e.walletAddress,createdAt:Date.now()};switch(this.saveTransaction(r),e.provider){case"tink":return this.processTinkWithdrawal(r);case"truelayer":return this.processTrueLayerWithdrawal(r);case"plaid":return this.processPlaidWithdrawal(r);case"chimoney":return this.processChimoneyWithdrawal(r);case"paystack":return this.processPaystackWithdrawal(r);default:throw Error("Unsupported provider")}}catch(e){throw this.handleError(e,"Failed to create withdrawal")}}async processTinkWithdrawal(e){return console.log("Processing Tink withdrawal:",e),e.status="processing",this.updateTransaction(e),e}async processTrueLayerWithdrawal(e){return console.log("Processing TrueLayer withdrawal:",e),e.status="processing",this.updateTransaction(e),e}async processPlaidWithdrawal(e){return console.log("Processing Plaid withdrawal:",e),e.status="processing",this.updateTransaction(e),e}async processChimoneyWithdrawal(e){return console.log("Processing Chimoney withdrawal:",e),e.status="processing",this.updateTransaction(e),e}async processPaystackWithdrawal(e){return console.log("Processing Paystack withdrawal:",e),e.status="processing",this.updateTransaction(e),e}async completeWithdrawal(e,t){let a=this.getTransaction(e);if(!a)throw Error("Transaction not found");return a.status="completed",a.completedAt=Date.now(),a.transactionHash=t,this.updateTransaction(a),a}async failWithdrawal(e,t){let a=this.getTransaction(e);if(!a)throw Error("Transaction not found");return a.status="failed",a.completedAt=Date.now(),a.failureReason=t,this.updateTransaction(a),a}async getTransactionStatus(e){return this.getTransaction(e)}getRecentTransactions(e=10){return[]}saveBankAccount(e){}getBankAccounts(){return[]}getExchangeRate(e,t){return({USDC:{USD:1,EUR:.91,GBP:.79,NGN:1550,KES:130,GHS:12,ZAR:18.5},USDT:{USD:1,EUR:.91,GBP:.79,NGN:1550,KES:130,GHS:12,ZAR:18.5},ETH:{USD:2500,EUR:2275,GBP:1975,NGN:3875e3,KES:325e3,GHS:3e4,ZAR:46250},MATIC:{USD:.83,EUR:.76,GBP:.66,NGN:1286,KES:108,GHS:10,ZAR:15.4}})[e]?.[t]||1}saveTransaction(e){}updateTransaction(e){}getTransaction(e){return null}}var d=a(7550),u=a(2941),g=a(381);function h(){let{user:e}=(0,i.a)();(0,n.useRouter)();let[t,a]=(0,s.useState)([]),[c,h]=(0,s.useState)("chimoney"),[m,x]=(0,s.useState)("100"),[p,y]=(0,s.useState)("USDC"),[b,w]=(0,s.useState)("USD"),[f,v]=(0,s.useState)(""),[N,k]=(0,s.useState)("0"),[j,P]=(0,s.useState)([]),[C,T]=(0,s.useState)(""),[S,A]=(0,s.useState)(!1),[D,E]=(0,s.useState)([]),[F,G]=(0,s.useState)(!1),[R,I]=(0,s.useState)({accountName:"",accountNumber:"",bankName:"",routingNumber:"",currency:"USD"}),U=async e=>{try{let t=u.t.getInstance(),a=await t.getBalance(e);k(a)}catch(e){console.error("Failed to load balance:",e)}};if(!e||"creator"!==e.role&&"admin"!==e.role)return null;let B=t.find(e=>e.name===c),W=async()=>{try{let e=d.X.getInstance(),t=await e.linkAccount();v(t.address),k(t.balance),g.Am.success("Wallet connected!")}catch(e){g.Am.error("Failed to connect wallet"),console.error(e)}},M=async()=>{if(!f){g.Am.error("Please connect your wallet first");return}if(!C){g.Am.error("Please select a bank account");return}let e=parseFloat(m);if(isNaN(e)||e<=0){g.Am.error("Please enter a valid amount");return}if(e>parseFloat(N)){g.Am.error("Insufficient balance");return}A(!0);try{let t=l.getInstance(),a=await t.createWithdrawal({provider:c,cryptoAmount:e,cryptoCurrency:p,fiatCurrency:b,bankAccountId:C,walletAddress:f});g.Am.success(`Withdrawal initiated! Transaction ID: ${a.transactionId}`),setTimeout(async()=>{await t.completeWithdrawal(a.transactionId,`0x${Math.random().toString(16).slice(2,66)}`),g.Am.success("Withdrawal completed successfully!"),E(t.getRecentTransactions(5)),U(f)},5e3),E(t.getRecentTransactions(5))}catch(e){g.Am.error("Failed to create withdrawal"),console.error(e)}finally{A(!1)}};return r.jsx(o.M,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Withdraw"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Convert your crypto to fiat and withdraw to your bank account."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Wallet Balance"}),f?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Available Balance"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[parseFloat(N).toFixed(4)," ETH"]})]}),r.jsx("span",{className:"text-3xl",children:"\uD83D\uDCB0"})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono",children:[f.slice(0,10),"...",f.slice(-8)]})]}):(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Connect your wallet to check balance."}),r.jsx("button",{onClick:W,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Connect Wallet"})]})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Bank Account"}),r.jsx("button",{onClick:()=>G(!F),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:F?"Cancel":"+ Add New"})]}),F?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Account Name *"}),r.jsx("input",{type:"text",value:R.accountName,onChange:e=>I({...R,accountName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"John Doe"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Account Number *"}),r.jsx("input",{type:"text",value:R.accountNumber,onChange:e=>I({...R,accountNumber:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"1234567890"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bank Name *"}),r.jsx("input",{type:"text",value:R.bankName,onChange:e=>I({...R,bankName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Chase Bank"})]}),r.jsx("button",{onClick:()=>{if(!R.accountName||!R.accountNumber||!R.bankName){g.Am.error("Please fill in all required fields");return}let e=l.getInstance(),t={id:`bank_${Date.now()}_${Math.random().toString(36).slice(2,9)}`,...R};e.saveBankAccount(t),P(e.getBankAccounts()),T(t.id),G(!1),I({accountName:"",accountNumber:"",bankName:"",routingNumber:"",currency:"USD"}),g.Am.success("Bank account added successfully!")},className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors",children:"Add Bank Account"})]}):0===j.length?r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No bank accounts added yet."}):(0,r.jsxs)("select",{value:C,onChange:e=>T(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[r.jsx("option",{value:"",children:"Select a bank account"}),j.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.bankName," - ",e.accountNumber.slice(-4)]},e.id))]})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Select Provider"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(e=>(0,r.jsxs)("button",{onClick:()=>h(e.name),className:`p-4 border-2 rounded-lg transition-all text-left ${c===e.name?"border-blue-600 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,children:[r.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:e.displayName}),r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:e.supportedRegions.join(", ")})]},e.name))})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Withdrawal Amount"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Crypto Amount"}),r.jsx("input",{type:"number",value:m,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"100"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Crypto Currency"}),(0,r.jsxs)("select",{value:p,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[r.jsx("option",{value:"USDC",children:"USDC"}),r.jsx("option",{value:"USDT",children:"USDT"}),r.jsx("option",{value:"ETH",children:"ETH"}),r.jsx("option",{value:"MATIC",children:"MATIC"})]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Receive Currency"}),r.jsx("select",{value:b,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:B?.supportedCurrencies.map(e=>r.jsx("option",{value:e,children:e},e))})]}),r.jsx("button",{onClick:M,disabled:S||!f||!C,className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:S?"Processing...":`Withdraw ${m} ${p}`})]})]})]}),r.jsx("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Recent Withdrawals"}),0===D.length?r.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"No recent withdrawals."}):r.jsx("div",{className:"space-y-3",children:D.map(e=>(0,r.jsxs)("div",{className:"p-3 border border-gray-200 dark:border-gray-700 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.fiatAmount.toFixed(2)," ",e.fiatCurrency]}),r.jsx("span",{className:`text-xs px-2 py-1 rounded ${"completed"===e.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"processing"===e.status?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"failed"===e.status?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}`,children:e.status})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.cryptoAmount," ",e.cryptoCurrency]}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:new Date(e.createdAt).toLocaleDateString()})]},e.transactionId))})]})})]})]})})}},2941:(e,t,a)=>{"use strict";a.d(t,{t:()=>o});var r=a(5320),s=a(6687),n=a(6166),i=a(1660);class o extends n.b{constructor(){super(),this.transactionService=i.p.getInstance()}static getInstance(){return o.instance||(o.instance=new o),o.instance}async sendPayment(e){try{await this.ensureConnection();let t=await this.getSigner(),a=r.fi(e.amount),s=await t.sendTransaction({to:e.to,value:a}),n=e.memo?`Payment: ${e.memo}`:`Payment of ${e.amount} ${e.currency||"ETH"}`;return await this.transactionService.trackTransaction(s.hash,n)}catch(e){throw this.handleError(e,"Failed to send payment")}}async sendBatchPayments(e){try{await this.ensureConnection();let t=[];for(let a of e.payments)try{let e=await this.sendPayment(a);t.push(e)}catch(e){throw console.error(`Failed to send payment to ${a.to}:`,e),e}return t}catch(e){throw this.handleError(e,"Failed to send batch payments")}}async estimateGas(e){try{await this.ensureConnection();let t=await this.getSigner(),a=r.fi(e.amount),s=await this.provider.estimateGas({to:e.to,value:a,from:await t.getAddress()}),n=await this.provider.getFeeData(),i=n.gasPrice||r.vz("20","gwei");return{gasLimit:s.toString(),gasPrice:r.bM(i,"gwei"),maxFeePerGas:n.maxFeePerGas?r.bM(n.maxFeePerGas,"gwei"):void 0,maxPriorityFeePerGas:n.maxPriorityFeePerGas?r.bM(n.maxPriorityFeePerGas,"gwei"):void 0,estimatedCost:r.dF(s*i)}}catch(e){throw this.handleError(e,"Failed to estimate gas")}}async estimateBatchGas(e){try{await this.ensureConnection();let t=BigInt(0),a=await this.provider.getFeeData(),s=a.gasPrice||r.vz("20","gwei");for(let a of e.payments){let e=await this.estimateGas(a);t+=BigInt(e.gasLimit)}let n=t*s;return{gasLimit:t.toString(),gasPrice:r.bM(s,"gwei"),maxFeePerGas:a.maxFeePerGas?r.bM(a.maxFeePerGas,"gwei"):void 0,maxPriorityFeePerGas:a.maxPriorityFeePerGas?r.bM(a.maxPriorityFeePerGas,"gwei"):void 0,estimatedCost:r.dF(n)}}catch(e){throw this.handleError(e,"Failed to estimate batch gas")}}async getBalance(e){try{await this.ensureConnection();let t=e;if(!t){let e=await this.getSigner();t=await e.getAddress()}let a=await this.provider.getBalance(t);return r.dF(a)}catch(e){throw this.handleError(e,"Failed to get balance")}}async validatePayment(e){try{if(!s.UJ(e.to))return{valid:!1,error:"Invalid recipient address"};let t=parseFloat(e.amount);if(isNaN(t)||t<=0)return{valid:!1,error:"Invalid amount"};let a=await this.getBalance(),r=parseFloat(a);if(r<t)return{valid:!1,error:"Insufficient balance"};let n=await this.estimateGas(e),i=t+parseFloat(n.estimatedCost);if(r<i)return{valid:!1,error:"Insufficient balance for gas fees"};return{valid:!0}}catch(e){return{valid:!1,error:"Validation failed"}}}async validateBatchPayment(e){try{let t=0;for(let a of e.payments){if(!s.UJ(a.to))return{valid:!1,error:`Invalid address: ${a.to}`};let e=parseFloat(a.amount);if(isNaN(e)||e<=0)return{valid:!1,error:`Invalid amount for ${a.to}`};t+=e}let a=await this.getBalance(),r=parseFloat(a);if(r<t)return{valid:!1,error:"Insufficient balance for all payments"};let n=await this.estimateBatchGas(e),i=t+parseFloat(n.estimatedCost);if(r<i)return{valid:!1,error:"Insufficient balance for gas fees"};return{valid:!0}}catch(e){return{valid:!1,error:"Validation failed"}}}}},1660:(e,t,a)=>{"use strict";a.d(t,{p:()=>o});var r,s=a(5320),n=a(6166);!function(e){e.PENDING="pending",e.CONFIRMED="confirmed",e.FAILED="failed"}(r||(r={}));var i=a(4045);class o extends n.b{static{this.STORAGE_KEY="web3_transactions"}static{this.MAX_STORED_TXS=50}constructor(){super()}static getInstance(){return o.instance||(o.instance=new o),o.instance}async trackTransaction(e,t){try{await this.ensureConnection();let a=await this.provider.getTransaction(e);a||i.q.throwError(Error("Transaction not found"),"trackTransaction");let n={hash:e,from:a.from,to:a.to||"",value:s.dF(a.value),status:r.PENDING,timestamp:Date.now(),description:t};this.saveTransaction(n);let o=await a.wait();return o&&(n.status=1===o.status?r.CONFIRMED:r.FAILED,n.blockNumber=o.blockNumber,n.gasUsed=o.gasUsed.toString(),n.effectiveGasPrice=o.gasPrice?.toString(),this.updateTransaction(n)),this.mapToReceipt(n)}catch(e){throw this.handleError(e,"Failed to track transaction")}}async getTransactionStatus(e){try{await this.ensureConnection();let t=await this.provider.getTransactionReceipt(e);if(!t)return r.PENDING;return 1===t.status?r.CONFIRMED:r.FAILED}catch(e){throw this.handleError(e,"Failed to get transaction status")}}async waitForTransaction(e,t=1){try{await this.ensureConnection();let a=await this.provider.waitForTransaction(e,t);a||i.q.throwError(Error("Transaction receipt not found"),"waitForTransaction");let s={hash:e,from:a.from,to:a.to||"",value:"0",status:1===a.status?r.CONFIRMED:r.FAILED,timestamp:Date.now(),blockNumber:a.blockNumber,gasUsed:a.gasUsed.toString(),effectiveGasPrice:a.gasPrice?.toString()};return this.updateTransaction(s),this.mapToReceipt(s)}catch(e){throw this.handleError(e,"Failed to wait for transaction")}}getRecentTransactions(e=10){try{return this.getStoredTransactions().slice(0,e).map(e=>this.mapToReceipt(e))}catch(e){return console.error("Failed to get recent transactions:",e),[]}}getPendingTransactions(){try{return this.getStoredTransactions().filter(e=>e.status===r.PENDING).map(e=>this.mapToReceipt(e))}catch(e){return console.error("Failed to get pending transactions:",e),[]}}clearTransactionHistory(){}saveTransaction(e){}updateTransaction(e){}getStoredTransactions(){return[]}mapToReceipt(e){return{hash:e.hash,from:e.from,to:e.to,value:e.value,blockNumber:e.blockNumber||0,status:e.status,timestamp:e.timestamp,gasUsed:e.gasUsed||"0",effectiveGasPrice:e.effectiveGasPrice||"0"}}async refreshPendingTransactions(){for(let e of this.getPendingTransactions())try{await this.getTransactionStatus(e.hash)!==r.PENDING&&await this.waitForTransaction(e.hash)}catch(t){console.error(`Failed to refresh transaction ${e.hash}:`,t)}}}},8022:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(8570).createProxy)(String.raw`/workspaces/web3-distribution/src/app/creator/withdraw/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[276,566,434,580,657],()=>a(3819));module.exports=r})();